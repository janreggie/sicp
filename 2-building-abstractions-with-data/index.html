<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://janreggie.github.io/sicp/2-building-abstractions-with-data/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>2 - SICP Exercises</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">
        <link href="../css/custom.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scheme.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">SICP Exercises</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">SICP Exercises</a>
                            </li>
                            <li class="navitem">
                                <a href="../1-building-abstractions-using-procedures/" class="nav-link">1</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">2</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../1-building-abstractions-using-procedures/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/janreggie/sicp/edit/master/docs/2-building-abstractions-with-data.markdown" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#building-abstractions-with-data" class="nav-link">Building Abstractions with Data</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#21-introduction-to-data-abstraction" class="nav-link">2.1 Introduction to Data Abstraction</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#exercise-21" class="nav-link">Exercise 2.1</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-22" class="nav-link">Exercise 2.2</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-23" class="nav-link">Exercise 2.3</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-24" class="nav-link">Exercise 2.4</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-25" class="nav-link">Exercise 2.5</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-26" class="nav-link">Exercise 2.6</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-27" class="nav-link">Exercise 2.7</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-28" class="nav-link">Exercise 2.8</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-29" class="nav-link">Exercise 2.9</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-210" class="nav-link">Exercise 2.10</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-211" class="nav-link">Exercise 2.11</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-212" class="nav-link">Exercise 2.12</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-213" class="nav-link">Exercise 2.13</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-214" class="nav-link">Exercise 2.14</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-215" class="nav-link">Exercise 2.15</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-216" class="nav-link">Exercise 2.16</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#22-hierarchial-data-and-the-closure-property" class="nav-link">2.2 Hierarchial Data and the Closure Property</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#exercise-217" class="nav-link">Exercise 2.17</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-218" class="nav-link">Exercise 2.18</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-219" class="nav-link">Exercise 2.19</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-220" class="nav-link">Exercise 2.20</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-221" class="nav-link">Exercise 2.21</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-222" class="nav-link">Exercise 2.22</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-223" class="nav-link">Exercise 2.23</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-224" class="nav-link">Exercise 2.24</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-225" class="nav-link">Exercise 2.25</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-226" class="nav-link">Exercise 2.26</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-227" class="nav-link">Exercise 2.27</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-228" class="nav-link">Exercise 2.28</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-229" class="nav-link">Exercise 2.29</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-230" class="nav-link">Exercise 2.30</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-231" class="nav-link">Exercise 2.31</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-232" class="nav-link">Exercise 2.32</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-233" class="nav-link">Exercise 2.33</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-234" class="nav-link">Exercise 2.34</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-235" class="nav-link">Exercise 2.35</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-236" class="nav-link">Exercise 2.36</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-237" class="nav-link">Exercise 2.37</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-238" class="nav-link">Exercise 2.38</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#exercise-239" class="nav-link">Exercise 2.39</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="building-abstractions-with-data">Building Abstractions with Data<a class="headerlink" href="#building-abstractions-with-data" title="Permanent link">&para;</a></h1>
<h2 id="21-introduction-to-data-abstraction">2.1 Introduction to Data Abstraction<a class="headerlink" href="#21-introduction-to-data-abstraction" title="Permanent link">&para;</a></h2>
<h3 id="exercise-21">Exercise 2.1<a class="headerlink" href="#exercise-21" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define (make-rat n d)
  (if (&lt; d 0)
    (make-rat (- n) (- d))
    (let ((g (abs (gcd n d))))
      (cons (/ n g) (/ d g)))))
</code></pre>

<p>Ensure that <code>d</code> is always positive, and make <code>g</code> always positive.</p>
<h3 id="exercise-22">Exercise 2.2<a class="headerlink" href="#exercise-22" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; make-point creates a pair of x-y coordinates
(define (make-point x y) (cons x y))

; x-point and y-point return the x and y coordinates of a point p
(define (x-point p) (car p))
(define (y-point p) (cdr p))

; print-point prints details about a point
(define (print-point p)
  (newline)
  (display &quot;(&quot;)
  (display (x-point p))
  (display &quot;,&quot;)
  (display (y-point p))
  (display &quot;)&quot;))

; make-segment creates a segment of two points
(define (make-segment p1 p2) (cons p1 p2))

; start-segment returns the first point of a segment
(define (start-segment s) (car s))

; end-segment returns the second point of a segment
(define (end-segment s) (cdr s))

(define ss (make-segment (make-point 1 2) (make-point 3 4)))
(print-point (start-segment ss)) ; ==&gt; (1,2)
(print-point (end-segment ss)) ; ==&gt; (3,4)
</code></pre>

<h3 id="exercise-23">Exercise 2.3<a class="headerlink" href="#exercise-23" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; make-rectangle creates a rectangle with c1, c2 as corners.
; Note that c1 and c2 can be anywhere in the plane,
; but the rectangle's segments will remain parallel to the x- and y-axes.
; For instance, c1=(1,4), c2=(4,2) creates a 3x2 rectangle.
(define (make-rectangle c1 c2) (cons c1 c2))

; width returns the width of the rectangle
(define (width r)
  (abs (- (x-point (car r)) (x-point (cdr r)))))

; height returns the height of the rectangle
(define (height r)
  (abs (- (y-point (car r)) (y-point (cdr r)))))

; perimeter computes for the perimeter of the rectangle.
; If the rectangle has zero width or height, it will return zero.
(define (perimeter r)
  (if (or (= (width r) 0) (= (height r) 0))
    0
    (* 2 (+ (width r) (height r)))))

; area returns the area of the rectangle.
(define (area r)
  (* (width r) (height r)))
</code></pre>

<p>All these functions can be tested as follows:</p>
<pre><code class="scheme">(define rect
  (make-rectangle
    (make-point 1 4)
    (make-point 5 1)))
(perimeter rect) ; ==&gt; 14
(area rect) ; ==&gt; 12
</code></pre>

<h3 id="exercise-24">Exercise 2.4<a class="headerlink" href="#exercise-24" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define (cons x y)
  (lambda (m) (m x y)))
</code></pre>

<p>The procedure <code>cons</code> takes in two parameters <code>x</code> and <code>y</code> and returns a procedure that takes in a callable object <code>m</code> and returns the value <code>(m x y)</code>.</p>
<pre><code class="scheme">(define (car z)
  (z (lambda (p q) p)))
</code></pre>

<p>The procedure <code>car</code> takes in a callable object <code>z</code>, which in turn takes in a function that takes two callable values <code>p</code> and <code>q</code>, and then return <code>q</code>.</p>
<p>This is actually a very clever way of "implementing" <code>cons</code> and <code>car</code>. The following is what goes on:</p>
<pre><code class="scheme">(define pt (cons 2 3))  ; pt = (lambda (m) (m 2 3))
(car pt)
; (pt (lambda (p q) p))
; ((lambda (m) (m 2 3)) (lambda (p q) p))
; ((lambda (p q) p) 2 3)
; 2
</code></pre>

<p>Now, let us try constructing a <code>cdr</code> using the example for <code>car</code>.</p>
<pre><code class="scheme">(define (cdr z)
  (z (lambda (p q) q)))
(cdr pt)
; (pt (lambda (p q) q))
; ((lambda (m) (m 2 3)) (lambda (p q) q))
; ((lambda (p q) q) 2 3)
; 3
</code></pre>

<h3 id="exercise-25">Exercise 2.5<a class="headerlink" href="#exercise-25" title="Permanent link">&para;</a></h3>
<p>This implementation requires repeatedly dividing the result by 2 or 3 to check how many 2's or 3's the value has.</p>
<pre><code class="scheme">(define (cons x y)
  (* (expt 2 x) (expt 3 y)))

(define (car p)
  (define (iter val res)
    (if (= (remainder val 2) 0)
      (iter (/ val 2) (+ res 1))
      res))
  (iter p 0))

(define (cdr p)
  (define (iter val res)
    (if (= (remainder val 3) 0)
      (iter (/ val 3) (+ res 1))
      res))
  (iter p 0))

(define pt (cons 3 4))
(car pt) ; ==&gt; 3
(cdr pt) ; ==&gt; 4
</code></pre>

<h3 id="exercise-26">Exercise 2.6<a class="headerlink" href="#exercise-26" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define zero (lambda (f) (lambda (x) x)))
</code></pre>

<p>This defines <code>zero</code> as a function that takes in a function <code>f</code> and returns... a function that takes in <code>x</code> and returns the same <code>x</code>.</p>
<pre><code class="scheme">(define (add-1 n)
  (lambda (f) (lambda (x) (f ((n f) x)))))
</code></pre>

<p>This defines <code>add-1</code> as a procedure that takes in a callable value <code>n</code> and returns a function that takes in <code>f</code> that returns a function that takes in <code>x</code> and returns <code>(f ((n f) x))</code>. Now that <em>is</em> mind-boggling...</p>
<p>Let us try solving for <code>(add-1 zero)</code>:</p>
<pre><code class="scheme">(add-1 zero)
; (add-1 (lambda (f) (lambda (x) x)))
; (lambda (f) (lambda (x) (f (((lambda (f) (lambda (x) x)) f) x))))
; (lambda (f) (lambda (x) (f ((lambda (x) x) x))))
; (lambda (f) (lambda (x) (f x)))
</code></pre>

<p>Notice what happened here: <code>(add-1 zero)</code> takes in a function <code>f</code> and returns a function that takes in <code>x</code> and returns <code>(f x)</code>.</p>
<p>Let us try to do that again.</p>
<pre><code class="scheme">(add-1 (add-1 zero))
; (add-1 (lambda (f) (lambda (x) (f x))))
; (lambda (f) (lambda (x) (f (((lambda (f) (lambda (x) (f x))) f) x))))
; (lambda (f) (lambda (x) (f ((lambda (x) (f x)) x))))
; (lambda (f) (lambda (x) (f (f x))))
</code></pre>

<p>Another <code>add-1</code> adds a call to <code>f</code>.</p>
<p>Since <code>(add-1 zero)</code> is just <code>one</code> and <code>(add-1 one)</code> is <code>two</code>, we can easily give direct definitions for them:</p>
<pre><code class="scheme">(define one (lambda (f) (lambda (x) (f x))))
(define two (lambda (f) (lambda (x) (f (f x)))))
</code></pre>

<p>We can also make a <code>+</code> procedure which takes in two "Church numerals" and return their sum. But how do we do this is another thing...</p>
<p>Suppose <code>a</code> is a Church numeral that represents the number <code>A</code> in Church encoding, i.e., <code>(lambda (f) (lambda (x) (f (f ... (f x))))))</code> where <code>f</code> is callled <code>A</code> times. Similarly, let <code>b</code> be a Church numeral that represents <code>B</code> in Church encoding.</p>
<p>Note <code>(a f)</code> and <code>(b f)</code> become <code>(lambda (x) (f (f ... (f x))))</code> where <code>f</code> is composed <code>A</code> and <code>B</code> times respectively. We would want to get a result such that the number of calls for <code>f</code> is <code>A+B</code>. Simple: <code>((a f) ((b f) x))</code>. <code>((b f) x)</code> returns <code>(f (f ... (f x)))</code> repeated <code>B</code> times, and that is wrapped around <code>(a f)</code> which calls <code>f</code> <code>A</code> times!</p>
<pre><code class="scheme">(define (+ a b)
  (lambda (f)
    (lambda (x)
      ((a f) ((b f) x)))))
</code></pre>

<h3 id="exercise-27">Exercise 2.7<a class="headerlink" href="#exercise-27" title="Permanent link">&para;</a></h3>
<p>The implementation of <code>make-interval</code> does not mandate <code>a</code> be less than <code>b</code> or vice versa. A check might be needed.</p>
<pre><code class="scheme">(define (lower-bound x) (min (car x) (cdr x)))
(define (upper-bound x) (max (car x) (cdr x)))
</code></pre>

<h3 id="exercise-28">Exercise 2.8<a class="headerlink" href="#exercise-28" title="Permanent link">&para;</a></h3>
<p>The difference between the two ranges is the range between the smallest possible difference to the largest possible one. The smallest possible difference can be taken by minimizing the first number and maximizing the second, while the largest possible one can be taken by maximizing the second number and minimizing the first.</p>
<p>Suppose that the first range is 5 to 8 and the second 1 to 2. The smallest possible difference is <span class="arithmatex">\(5-2=3\)</span> while the largest one is <span class="arithmatex">\(8-1=7\)</span>. Implementing it should be easy.</p>
<pre><code class="scheme">; sub-interval determines the interval for the difference between x and y
(define (sub-interval x y)
  (make-interval
    (- (lower-bound x) (upper-bound y))
    (- (upper-bound x) (lower-bound y))))
(define a (make-interval 5 8))
(define b (make-interval 1 2))
(sub-interval a b) ; 3 - 7
</code></pre>

<h3 id="exercise-29">Exercise 2.9<a class="headerlink" href="#exercise-29" title="Permanent link">&para;</a></h3>
<p>Suppose <span class="arithmatex">\(x=\left[a,b\right]\)</span> and <span class="arithmatex">\(y=\left[c,d\right]\)</span>, and <span class="arithmatex">\(W\left(x\right)\)</span> be the width function for <span class="arithmatex">\(x\)</span>. Hence, <span class="arithmatex">\(W\left(x\right)=\frac{b-a}{2}\)</span> and <span class="arithmatex">\(W\left(y\right)=\frac{d-c}{2}\)</span>.</p>
<p>We see that <span class="arithmatex">\(x+y=[a+c,b+d]\)</span> and <span class="arithmatex">\(x-y=[a-d,b-c]\)</span>. Astonishingly, <span class="arithmatex">\(W\left(x+y\right)=W\left(x-y\right)=\frac{\left(b+d\right)-\left(a+c\right)}{2}\)</span>, which subsequently equals <span class="arithmatex">\(W\left(x\right)+W\left(y\right)\)</span>.</p>
<p>For multiplication, <span class="arithmatex">\(x\times y = \left[\max\left(ac,ad,bc,bd\right), \min\left(ac,ad,bc,bd\right)\right]\)</span>, and so <span class="arithmatex">\(W\left(x\times y\right)\)</span> can become uncertain, hence there is no direct relationship between that and either of <span class="arithmatex">\(W\left(x\right)\)</span> and <span class="arithmatex">\(W\left(y\right)\)</span>. This goes the same with division, which is dependent on multiplication.</p>
<h3 id="exercise-210">Exercise 2.10<a class="headerlink" href="#exercise-210" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define (div-interval x y)
  ; spans-zero returns true if x spans zero by checking its signs
  (define (spans-zero x)
    (&lt; (* (lower-bound x) (upper-bound x)) 0))
  (if (spans-zero y)
    (error &quot;Dividend spans zero&quot;)
    (mul-interval x
      (make-interval
        (/ 1.0 (upper-bound y))
        (/ 1.0 (lower-bound y))))))
(div-interval
  (make-interval 1 5)
  (make-interval 2 3)) ; returns something alright
(div-interval
  (make-interval 1 5)
  (make-interval -2 3)) ; returns an error
</code></pre>

<h3 id="exercise-211">Exercise 2.11<a class="headerlink" href="#exercise-211" title="Permanent link">&para;</a></h3>
<p>Suppose <span class="arithmatex">\(S\left(x\right)\)</span> has the following property:</p>
<div class="arithmatex">\[
S\left(\left[a,b\right]\right) = \left\{\begin{array}{lr}
    -1 &amp; \text{if } a \lt 0 \text{ and } b \lt 0\\
    0  &amp; \text{if } a \lt 0 \text{ and } b \ge 0\\
    1  &amp; \text{if } a \ge 0 \text{ and } b \ge 0
    \end{array}\right.
\]</div>
<p>With <span class="arithmatex">\(x=\left[a,b\right]\)</span> and <span class="arithmatex">\(y=\left[c,d\right]\)</span>, there are nine possible combinations for <span class="arithmatex">\(x\times y\)</span> determined by their <span class="arithmatex">\(S\)</span>-values:</p>
<div class="arithmatex">\[
% painstakingly transcribed using https://isaurssaurav.github.io/mathjax-table-generator/
\begin{array} {|r|r|}\hline _{S(x)} \backslash ^{S(y)} &amp; -1 &amp; 0 &amp; 1 \\ \hline -1 &amp; \left[bd,ac\right] &amp; \left[ad,ac\right] &amp; \left[ad,bc\right] \\ \hline 0 &amp; \left[bc,ac\right] &amp; \star &amp; \left[ad,bd\right] \\ \hline 1 &amp; \left[bc,ad\right] &amp; \left[bc,bd\right] &amp; \left[ac,bd\right] \\ \hline  \end{array}
\]</div>
<p>These ranges have been computed by hand. Consider when <span class="arithmatex">\(S\left(x\right)=1\)</span> and <span class="arithmatex">\(S\left(y\right)=0\)</span>. In this case, the smallest possible number could be taken from <span class="arithmatex">\(b\)</span>, the larger positive number in the range <span class="arithmatex">\(x\)</span>, multiplied to <span class="arithmatex">\(c\)</span>, the smallest negative number in <span class="arithmatex">\(y\)</span>. Similarly, the largest possible number in the product could be taken from <span class="arithmatex">\(b\)</span> multiplied to <span class="arithmatex">\(d\)</span>, the largest positive number in <span class="arithmatex">\(y\)</span>. (Try using the example <span class="arithmatex">\(x=\left[1,4\right]\)</span> and <span class="arithmatex">\(y=\left[-2,3\right]\)</span>.)</p>
<p>The middle case, when both <span class="arithmatex">\(x\)</span> and <span class="arithmatex">\(y\)</span> span zero, is a bit stranger. The negative extrema <span class="arithmatex">\(bc\)</span> and <span class="arithmatex">\(ad\)</span>, and the positive extrema <span class="arithmatex">\(ac\)</span> and <span class="arithmatex">\(bd\)</span>, can be smaller or larger than the other. One has to perform the multiplication operations manually and check the largest value from there.</p>
<p>The following is an implementation:</p>
<pre><code class="scheme">; mul-interval is an implementation of multiplying two intervals
; which uses two multiplication operations most of the time
(define (mul-interval x y)
  ; neg be less than zero and nonneg be its complement
  (define (neg n) (&lt; n 0))
  (define (nonneg n) (&gt;= n 0))

  ; s be the s-value of a range
  (define (s x)
    (cond
      ((and (neg (lower-bound x)) (neg (upper-bound x))) -1)
      ((and (neg (lower-bound x)) (nonneg (upper-bound x))) 0)
      (else 1)))

  ; now for the great conditional
  (let ((a (lower-bound x))
      (b (upper-bound x))
      (c (lower-bound y))
      (d (upper-bound y))
      (sx (s x))
      (sy (s y)))
    (cond
      ((and (= sx -1) (= sy -1)) (make-interval (* b d) (* a c)))
      ((and (= sx -1) (= sy 0))  (make-interval (* a d) (* a c)))
      ((and (= sx -1) (= sy 1))  (make-interval (* a d) (* b c)))
      ((and (= sx 0)  (= sy -1)) (make-interval (* b c) (* a c)))
      ; skipping sx=0 and sy=0 and putting that as the else statement
      ((and (= sx 0)  (= sy 1))  (make-interval (* a d) (* b d)))
      ((and (= sx 1)  (= sy -1)) (make-interval (* b c) (* a d)))
      ((and (= sx 1)  (= sy 0))  (make-interval (* b c) (* b d)))
      ((and (= sx 1)  (= sy 1))  (make-interval (* a c) (* b d)))
      (else
        (let ((ac (* a c))
            (ad (* a d))
            (bc (* b c))
            (bd (* b d)))
          (make-interval (min ad bc) (max ac bd)))))))
</code></pre>

<p>Tests can be done by writing two intervals, multiplying them using this and the original implementation, and checking if they are equal.</p>
<p>How much readability one is willing to trade off for performance is dependent on the one who writes the code.</p>
<h3 id="exercise-212">Exercise 2.12<a class="headerlink" href="#exercise-212" title="Permanent link">&para;</a></h3>
<p>With some center <span class="arithmatex">\(c\)</span> and a percent tolerance <span class="arithmatex">\(p&lt;1\)</span>, the range should be <span class="arithmatex">\(\left[c\left(1-p\right), c\left(1+p\right)\right]\)</span>.</p>
<pre><code class="scheme">; make-center-percent makes an interval with center c and percent tolerance p.
; For example, if c=6.8 and p=10, the interval is between 6.8-(6.8*10%) and 6.8+(6.8*10%),
; which is 6.12 and 7.48.
(define (make-center-percent c p)
  (make-interval
    (* c (- 1.0 (/ p 100.0)))
    (* c (+ 1.0 (/ p 100.0)))))
(make-center-percent 6.8 10) ; 6.12 - 7.48
</code></pre>

<h3 id="exercise-213">Exercise 2.13<a class="headerlink" href="#exercise-213" title="Permanent link">&para;</a></h3>
<p>Suppose there are two ranges: the first one having a center of <span class="arithmatex">\(c_1\)</span> and percentage tolerance <span class="arithmatex">\(p_1\)</span>, and the second having <span class="arithmatex">\(c_2\)</span> and <span class="arithmatex">\(p_2\)</span>. Henceforth, the two ranges are <span class="arithmatex">\(\left[{c_1}\left(1-{p_1}\right), {c_1}\left(1+{p_1}\right)\right]\)</span> and <span class="arithmatex">\(\left[{c_2}\left(1-{p_2}\right), {c_2}\left(1+{p_2}\right)\right]\)</span>.</p>
<p>With the assumption that all numbers are positive, the product should have the range <span class="arithmatex">\(\left[{c_1}{c_2}\left(1-{p_1}\right)\left(1-{p_2}\right), {c_1}{c_2}\left(1+{p_1}\right)\left(1+{p_2}\right)\right]\)</span>, which can be written as <span class="arithmatex">\(\left[{c_1}{c_2}\left(1-\left({p_1}+{p_2}\right)+{p_1}{p_2}\right), {c_1}{c_2}\left(1+\left({p_1}+{p_2}\right)+{p_1}{p_2}\right)\right]\)</span>.</p>
<p>If <span class="arithmatex">\(p_1\)</span> and <span class="arithmatex">\(p_2\)</span> are <em>sufficiently</em> small, <span class="arithmatex">\({p_1}{p_2}\)</span> can be negligible, and the range is written as <span class="arithmatex">\(\left[{c_1}{c_2}\left(1-\left({p_1}+{p_2}\right)\right), {c_1}{c_2}\left(1+\left({p_1}+{p_2}\right)\right)\right]\)</span>, which is a range with center <span class="arithmatex">\({c_1}{c_2}\)</span> and percentage tolerance <span class="arithmatex">\({p_1}+{p_2}\)</span>.</p>
<h3 id="exercise-214">Exercise 2.14<a class="headerlink" href="#exercise-214" title="Permanent link">&para;</a></h3>
<p>Using a simple test, we see that the two procedures do output different values:</p>
<pre><code class="scheme">(define r1 (make-center-percent 6800 10))
(define r2 (make-center-percent 3000 25))
(par1 r1 r2) ; (1226.179875333927 . 3351.2544802867387)
(par2 r1 r2) ; (1645.1612903225807 . 2497.773820124666)
</code></pre>

<p>Suppose <span class="arithmatex">\(x=\left[a,b\right]\)</span> and <span class="arithmatex">\(y=\left[c,d\right]\)</span>. We see that <span class="arithmatex">\(x+y=\left[a+c,b+d\right]\)</span> and <span class="arithmatex">\(x\times y=\left[ac, bd\right]\)</span>. Let us consider, however, what <code>div-interval</code> does:</p>
<pre><code class="scheme">(define (div-interval x y)
  (mul-interval x
    (make-interval
      (/ 1.0 (upper-bound y))
      (/ 1.0 (lower-bound y)))))
</code></pre>

<p>Or, in mathematical terms:</p>
<div class="arithmatex">\[
\begin{aligned}
\left[a,b\right]\div\left[c,d\right] &amp;= \left[a,b\right]\times \left[\frac{1}{d}, \frac{1}{c}\right] \\
  &amp;= \left[\frac{a}{d}, \frac{b}{c}\right]
\end{aligned}
\]</div>
<p>Interestingly, if we have a range <span class="arithmatex">\([a,b]\)</span> divided by itself:</p>
<div class="arithmatex">\[
\begin{aligned}
\left[a,b\right]\div\left[a,b\right] &amp;= \left[\frac{a}{b}, \frac{b}{a}\right]
\end{aligned}
\]</div>
<p>The current system does not have an identity principle. More on this later.</p>
<p>From here, we can analyze the behaviors of <code>par1</code> and <code>par2</code>:</p>
<div class="arithmatex">\[
\begin{aligned}
\text{par1}\left(x,y\right) &amp;= \left(x\times y\right) \div \left(x+y\right) \\
  &amp;= \left[ac, bd\right] \div \left[a+c, b+d\right] \\
  &amp;= \left[\frac{ac}{b+d}, \frac{bd}{a+c}\right]
\end{aligned}
\]</div>
<div class="arithmatex">\[
\begin{aligned}
\text{par2}\left(x,y\right) &amp;= \left[1, 1\right] \div \left(\left(\left[1,1\right] \div x\right) + \left(\left[1,1\right] \div y\right)\right) \\
  &amp;= \left[1,1\right] \div \left(\left(\left[1,1\right] \div \left[a,b\right]\right) + \left(\left[1,1\right] \div \left[c,d\right]\right)\right) \\
  &amp;= \left[1,1\right] \div \left(\left[\frac{1}{b}, \frac{1}{a}\right] + \left[\frac{1}{d}, \frac{1}{c}\right]\right) \\
  &amp;= \left[1,1\right] \div \left(\left[\frac{1}{b} + \frac{1}{d}, \frac{1}{a} + \frac{1}{c}\right]\right) \\
  &amp;= \left[\frac{1}{\frac{1}{a} + \frac{1}{c}} , \frac{1}{\frac{1}{b} + \frac{1}{d}} \right] \\
  &amp;= \left[\frac{ac}{a+c} , \frac{bd}{b+d} \right]
\end{aligned}
\]</div>
<h3 id="exercise-215">Exercise 2.15<a class="headerlink" href="#exercise-215" title="Permanent link">&para;</a></h3>
<p>Let us consider the results of the previous exercise. We have to remember that <span class="arithmatex">\(a&lt;b\)</span> and <span class="arithmatex">\(c&lt;d\)</span>. Therefore, <span class="arithmatex">\(a+c &lt; b+d\)</span>, and this implies that <span class="arithmatex">\(\left[\frac{ac}{b+d}, \frac{bd}{a+c}\right]\)</span> has a <em>wider</em> range than <span class="arithmatex">\(\left[\frac{ac}{a+c} , \frac{bd}{b+d} \right]\)</span> because of the denominators of the parameters of the former.</p>
<p>While it may be computationally cheaper to compute for <span class="arithmatex">\({x}\times{y}\)</span> in <code>par1</code>, this will introduce a much larger range than <code>par2</code>. This is perhaps the "uncertainty" that Eva Lu Ator is describing.</p>
<h3 id="exercise-216">Exercise 2.16<a class="headerlink" href="#exercise-216" title="Permanent link">&para;</a></h3>
<p>Consider the lack of identity in <code>div-interval</code>. Because of this, <span class="arithmatex">\(x + y \div y \neq x\)</span>. The two expressions should be equivalent, but they aren't. A principle of "identity" should be established where a program knows if an operation is applied to two "same" intervals, although doing so is a lot harder than it looks, and I can't say if it even were possible.</p>
<h2 id="22-hierarchial-data-and-the-closure-property">2.2 Hierarchial Data and the Closure Property<a class="headerlink" href="#22-hierarchial-data-and-the-closure-property" title="Permanent link">&para;</a></h2>
<h3 id="exercise-217">Exercise 2.17<a class="headerlink" href="#exercise-217" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; last-pair returns a pair which only contains the last element of a given list
(define (last-pair items)
  (if (null? (cdr items))
    items
    (last-pair (cdr items))))
(last-pair (list 23 72 149 34)) ; (34)
</code></pre>

<h3 id="exercise-218">Exercise 2.18<a class="headerlink" href="#exercise-218" title="Permanent link">&para;</a></h3>
<p>Note that <code>(cdr items)</code> returns either a list or nil, and <code>(car items)</code> returns a single number. From here, how are we able to reverse a list? Of course, without using the built-in <code>reverse</code>.</p>
<p>Remember that <code>last-pair</code> takes in the last "pair" of the list (its <code>cdr</code> is an empty value, so really it's a pair with only one element). This can be a very useful procedure.</p>
<p>A <code>reverse</code> procedure would use <code>last-pair</code> to get the very last item, and a <code>all-but-last</code> procedure which returns the entire list without the very last element.</p>
<pre><code class="scheme">(define (all-but-last items)
  (if (null? (cdr items))
    ()
    (cons (car items) (all-but-last (cdr items)))))
(all-but-last (list 23 72 149 34)) ; (23 72 149)

(define (reverse items)
  (if (null? items)
    items
    (cons (car (last-pair items)) (reverse (all-but-last items)))))
(reverse (list 23 72 149 34)) ; (34 149 72 23)
</code></pre>

<h3 id="exercise-219">Exercise 2.19<a class="headerlink" href="#exercise-219" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; first-denomination returns the first item on items
(define (first-denomination items)
  (car items))

; except-first-denomination returns items but the first one
(define (except-first-denomination items)
  (cdr items))

; no-more? checks if items is empty
(define (no-more? items)
  (null? items))

; using the previous procedures, as well as those in the book
(cc 100 us-coins) ; 292
</code></pre>

<p>On whether order matters for <code>coin-values</code>, after every iteration, <code>cc</code> branches between when <code>first-denomination</code> has been chosen, and when it isn't and <code>first-denomination</code> is no longer available as an option. The order of the coins should not matter, since all permutations will be attempted.</p>
<p>A simple demonstration of this, although definitely not solid proof, can be seen if <code>us-coins</code> were reversed:</p>
<pre><code class="scheme">(cc 100 (reverse us-coins)) ; also 292
</code></pre>

<h3 id="exercise-220">Exercise 2.20<a class="headerlink" href="#exercise-220" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define (same-parity . items)
  (define (is-same-parity? x) (= (remainder (car items) 2) (remainder x 2)))
  (filter is-same-parity? items))
(same-parity 1 2 3 4 5 6 7) ; (1 3 5 7)
(same-parity 2 3 4 5 6 7) ; (2 4 6)
</code></pre>

<p>Wait, we aren't allowed to use <code>filter</code> yet? Okay then.</p>
<pre><code class="scheme">(define (same-parity . items)
  (define (is-same-parity? x) (= (remainder (car items) 2) (remainder x 2)))

  ; recurse recurses through items with is-same-parity? and returns accum
  (define (recurse items accum)
    (cond
      ((null? items) accum)
      ((is-same-parity? (car items)) (recurse (cdr items) (cons (car items) accum)))
      (else (recurse (cdr items) accum))))

  ; one call to reverse since accum appends to the left every time
  (reverse (recurse items ())))
(same-parity 1 2 3 4 5 6 7) ; (1 3 5 7)
(same-parity 2 3 4 5 6 7) ; (2 4 6)
</code></pre>

<h3 id="exercise-221">Exercise 2.21<a class="headerlink" href="#exercise-221" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define (square-list items)
  (if (null? items)
    () ; &quot;nil&quot;
    (cons (square (car items)) (square-list (cdr items)))))
(square-list (list 1 2 3 4))

(define (square-list items)
  (map square items))
(square-list (list 1 2 3 4))
</code></pre>

<h3 id="exercise-222">Exercise 2.22<a class="headerlink" href="#exercise-222" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define (square-list items)
  (define (iter things answer)
    (if (null? things)
      answer
      (iter (cdr things)
        (cons (square (car things))
          answer))))
  (iter items ()))
(square-list (list 1 2 3 4))
; (iter (list 1 2 3 4) ())
; (iter (list 2 3 4) (cons (square 1) ()))
; (iter (list 2 3 4) (list 1))
; (iter (list 3 4) (cons (square 2) (list 1)))
; (iter (list 3 4) (list 4 1))
; (iter (list 4) (cons (square 3) (list 4 1)))
; (iter (list 4) (list 9 4 1))
; (iter () (cons (square 4) (list 9 4 1)))
; (iter () (list 16 9 4 1))
; (list 16 9 4 1)
</code></pre>

<p>For every subsequent value taken from <code>things</code>, it is appended at the start of <code>answer</code>. The answers are stacked FILO.</p>
<pre><code class="scheme">(define (square-list items)
  (define (iter things answer)
    (if (null? things)
      answer
      (iter (cdr things)
        (cons answer
          (square (car things))))))
  (iter items ()))
(square-list (list 1 2 3 4))
; (iter (list 1 2 3 4) ())
; (iter (list 2 3 4) (cons () (square 1)))
; (iter (list 2 3 4) (list () 1))
; (iter (list 3 4) (cons (list () 1) (square 2)))
; (iter (list 3 4) (list (list () 1) 4))
; (iter (list 4) (cons (list (list () 1) 4) (square 3)))
; (iter (list 4) (list (list (list () 1) 4) 9))
; (iter () (cons (list (list (list () 1) 4) 9) (square 4)))
; (iter () (list (list (list (list () 1) 4) 9) 16))
; (list (list (list (list () 1) 4) 9) 16)
</code></pre>

<p>The problem here is that a list is <code>cons</code>'d to a value, which should be the other way around. The final pair has a <em>list</em> in its first half, and a single <em>value</em> at its second. This will yield MIT Scheme to display something weird:</p>
<pre><code class="text">1 ]=&gt; (square-list (list 1 2 3 4))
;Value: ((((() . 1) . 4) . 9) . 16)
</code></pre>

<h3 id="exercise-223">Exercise 2.23<a class="headerlink" href="#exercise-223" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define (for-each f items)
  (define (execute-and-iterate f items)
    (f (car items))
    (for-each f (cdr items)))

  (if (not (null? items))
    (execute-and-iterate f items)))

(for-each
  (lambda (x) (newline) (display x))
  (list 57 321 88))
; 57
; 321
; 88
; returns unspecified value
</code></pre>

<h3 id="exercise-224">Exercise 2.24<a class="headerlink" href="#exercise-224" title="Permanent link">&para;</a></h3>
<pre><code class="text">1 ]=&gt; (list 1 (list 2 (list 3 4)))
;Value: (1 (2 (3 4)))
</code></pre>

<p>This looks like an interesting list. Let us graph it, then.</p>
<p><img alt="Image of the graph in cons-cell diagram form" src="/img/2-24.png" /></p>
<p>Notice, that this graph represents three lists, each of length 2. This is different from <code>(list 1 2 3 4)</code>, which would return a single list of length 4.</p>
<h3 id="exercise-225">Exercise 2.25<a class="headerlink" href="#exercise-225" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(car (cdr (car (cdr (cdr (list 1 3 (list 5 7) 9)))))) ; 7
(car (car (list (list 7)))) ; 7
(cdr (car (cdr (car (cdr (car (cdr (car (cdr (car (cdr (list 1 (list 2 (list 3 (list 4 (list 5 (list 6 7))))))))))))))))) ; 7
</code></pre>

<h3 id="exercise-226">Exercise 2.26<a class="headerlink" href="#exercise-226" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define x (list 1 2 3))
(define y (list 4 5 6))

; append appends two lists and combines their items
(append x y) ; (1 2 3 4 5 6)

; cons creates a cons pair of two items. Note that y is &quot;linked&quot; to the result
(cons x y) ; ((1 2 3) 4 5 6)

; list creates a list of the items it is provided with
(list x y) ; ((1 2 3) (4 5 6))
</code></pre>

<h3 id="exercise-227">Exercise 2.27<a class="headerlink" href="#exercise-227" title="Permanent link">&para;</a></h3>
<p>This is quite an interesting one. A reversal must also be done not only to the list in question, but to the items of the items if they do exist.</p>
<pre><code class="scheme">(define (all-but-last items)
  (if (null? (cdr items))
    ()
    (cons (car items) (all-but-last (cdr items)))))
(all-but-last (list 23 72 149 34)) ; (23 72 149)

; deep-reverse reverses items and its subitems
(define (deep-reverse items)
  (cond
    ((null? items) items)
    ((not (list? items)) items)
    (else (cons (deep-reverse (car (last-pair items))) (deep-reverse (all-but-last items))))))

(define x (list (list 1 2) (list 3 4)))
(reverse x) ; ((3 4) (1 2))
(deep-reverse x) ; ((4 3) (2 1))
</code></pre>

<h3 id="exercise-228">Exercise 2.28<a class="headerlink" href="#exercise-228" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; fringe takes in items and returns a single flattened list
(define (fringe items)
  (cond
    ((null? items) items)
    ((not (list? items)) (list items))
    (else (append (fringe (car items)) (fringe (cdr items))))))
(define x (list (list 1 2) (list 3 4)))
(fringe x) ; (1 2 3 4)
(fringe (list x x)) ; (1 2 3 4 1 2 3 4)
</code></pre>

<h3 id="exercise-229">Exercise 2.29<a class="headerlink" href="#exercise-229" title="Permanent link">&para;</a></h3>
<p>The following are the selectors for the <code>mobile</code> and <code>branch</code> structures defined by <code>make-mobile</code> and <code>make-branch</code>:</p>
<pre><code class="scheme">; left-branch returns the left branch of a mobile
(define (left-branch mobile) (car mobile))

; right-branch returns the right branch of a mobile
(define (right-branch mobile) (car (cdr mobile)))

; branch-length returns the length of a branch
(define (branch-length branch) (car branch))

; branch-structure returns the structure attached to the branch
(define (branch-structure branch) (car (cdr branch)))
</code></pre>

<p>The following is an implementation for <code>total-weight</code>:</p>
<pre><code class="scheme">; total-weight returns the total weight of a mobile. Returns itself if mobile is a number.
(define (total-weight mobile)
  (if (pair? mobile) ; i.e., mobile is represented by a pair i.e., it *is* a mobile
    (+ (total-weight (branch-structure (left-branch mobile)))
      (total-weight (branch-structure (right-branch mobile))))
    mobile))
</code></pre>

<p>Why I used <code>pair?</code> instead of <code>list?</code> is such that, in a later problem, the mobile and branch structures will be represented by <code>cons</code> instead of <code>list</code>. All <code>cons</code> are <code>list</code>s but not the other way around!</p>
<p>The following is an implementation for <code>balanced?</code>:</p>
<pre><code class="scheme">; torque returns the torque of a branch
(define (torque branch)
  (* (branch-length branch) (total-weight (branch-structure branch))))

; balanced? checks if a mobile is balanced. Returns true if mobile is a number
(define (balanced? mobile)
  (if (not (pair? mobile))
    #t
    (= (torque (left-branch mobile))
      (torque (right-branch mobile)))))
</code></pre>

<p>Going to the fourth problem, by doing this, we would only need to change <code>(car (cdr ...))</code> to <code>(cdr ...)</code>:</p>
<pre><code class="scheme">; left-branch returns the left branch of a mobile
(define (left-branch mobile) (car mobile))

; right-branch returns the right branch of a mobile
(define (right-branch mobile) (cdr mobile))

; branch-length returns the length of a branch
(define (branch-length branch) (car branch))

; branch-structure returns the structure attached to the branch
(define (branch-structure branch) (cdr branch))
</code></pre>

<h3 id="exercise-230">Exercise 2.30<a class="headerlink" href="#exercise-230" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; square-tree squares a tree
(define (square-tree tree)
  (map (lambda (sub-tree)
      (if (pair? sub-tree)
        (square-tree sub-tree)
        (square sub-tree)))
    tree))
(square-tree
 (list 1
       (list 2 (list 3 4) 5)
       (list 6 7))) ; ==&gt; (1 (4 (9 16) 25) (36 49))
</code></pre>

<h3 id="exercise-231">Exercise 2.31<a class="headerlink" href="#exercise-231" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; tree-map maps f to tree such that element -&gt; (f element)
(define (tree-map f tree)
  (map (lambda (sub-tree)
      (if (pair? sub-tree)
        (tree-map f sub-tree)
        (f sub-tree)))
    tree))
</code></pre>

<h3 id="exercise-232">Exercise 2.32<a class="headerlink" href="#exercise-232" title="Permanent link">&para;</a></h3>
<p>For each element <code>e</code> which is an element of <code>S</code>, all subsets of <code>S</code> will either have <code>e</code>, or not.</p>
<pre><code class="scheme">(define (subsets s)
  (if (null? s)
    (list ())
    (let ((rest (subsets (cdr s))))
      (append
        rest
        (map (lambda (subset) (cons (car s) subset)) rest)))))
(subsets (list 1 2 3)) ; ==&gt; (() (3) (2) (2 3) (1) (1 3) (1 2) (1 2 3))
</code></pre>

<p>The return value is the combination of <code>rest</code>, which are the subsets of <code>cdr s</code>, and <code>(map (lambda (subset) (cons (car s) subset)) rest)</code>, which is <code>car s</code> appended to each value of <code>rest</code>. Every element in the return value will either have <code>car s</code> or not.</p>
<h3 id="exercise-233">Exercise 2.33<a class="headerlink" href="#exercise-233" title="Permanent link">&para;</a></h3>
<p><code>map</code> is defined as accumulating a list using <code>sequence</code> by repeatedly applying <code>(p elem)</code> to every <code>elem</code>:</p>
<pre><code class="scheme">(define (map p sequence)
  (accumulate
    (lambda (x y) (cons (p x) y))
    ()
    sequence))
</code></pre>

<p><code>append</code> performs a <code>cons</code> for every <code>elem</code> of <code>seq1</code> into <code>seq2</code>:</p>
<pre><code class="scheme">(define (append seq1 seq2)
  (accumulate cons seq2 seq1))
</code></pre>

<p><code>length</code> iterates the value by 1 every time an element is encountered:</p>
<pre><code class="scheme">(define (length sequence)
  (accumulate
    (lambda (_ y) (+ y 1))
    0
    sequence))
</code></pre>

<h3 id="exercise-234">Exercise 2.34<a class="headerlink" href="#exercise-234" title="Permanent link">&para;</a></h3>
<p>In the problem statement, the keyword <code>higher-terms</code> was used, which was a bit of a misnomer and threw me off for a while.</p>
<pre><code class="scheme">; horner-eval performs a Horner evaluation on coefficient-sequence with a particular x.
(define (horner-eval x coefficient-sequence)
  (accumulate
    (lambda (this-coeff higher-terms)
      (+ this-coeff (* higher-terms x)))
    0
    coefficient-sequence))
(horner-eval 2 (list 1 3 0 5 0 1)) ; ==&gt; 79
</code></pre>

<h3 id="exercise-235">Exercise 2.35<a class="headerlink" href="#exercise-235" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; count-leaves counts the number of leaves in t
(define (count-leaves t)
  (accumulate
    (lambda (current-value total)
      (+ total (length current-value)))
    0
    (map enumerate-tree t)))
</code></pre>

<h3 id="exercise-236">Exercise 2.36<a class="headerlink" href="#exercise-236" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; accumulate-n takes in a sequence of sequences and accumulates using op and init.
(define (accumulate-n op init seqs)
  (if (null? (car seqs))
    ()
    (cons (accumulate op init (map car seqs))
      (accumulate-n op init (map cdr seqs)))))
(define s (list (list 1 2 3) (list 4 5 6) (list 7 8 9) (list 10 11 12)))
(accumulate-n + 0 s) ; ==&gt; (22 26 30)
</code></pre>

<p>Inside the <code>cons</code> statement, we combine two values: the accumulated result of the first items of <code>seqs</code>, and the results of the remaining items of <code>seqs</code>. To get the first items of <code>seqs</code>, <code>(map car seqs)</code> is used, where every sequence is mapped to <code>car</code> thus returning the first item. Similarly, to get the remaining items of <code>seqs</code>, <code>(map cdr seqs)</code> is used.</p>
<h3 id="exercise-237">Exercise 2.37<a class="headerlink" href="#exercise-237" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">; matrix-*-vector performs a multiplication between a matrix and a vector
; and returns a vector
(define (matrix-*-vector m v)
  (map
    (lambda (row) (dot-product row v))
    m))

; Example from https://mathinsight.org/matrix_vector_multiplication
(matrix-*-vector
  (list
    (list 1 -1 2)
    (list 0 -3 1))
  (list 2 1 0)) ; (1 -3)

; transpose transposes a matrix
(define (transpose mat)
  (accumulate-n
    cons ; used to append each element for every column in the matrix
    ()
    mat))

; Example from https://en.wikipedia.org/wiki/Transpose
(transpose
  (list
    (list 1 2)
    (list 3 4)
    (list 5 6))) ; ((1 3 5) (2 4 6))

; matrix-*-matrix performs a multiplication between two matrices
(define (matrix-*-matrix m n)
  (let ((cols (transpose n)))
    (map
      (lambda (row)
        (matrix-*-vector cols row))
      m)))

; Example from https://mathinsight.org/matrix_vector_multiplication
(matrix-*-matrix
  (list
    (list 0 4 -2)
    (list -4 -3 0))
  (list
    (list 0 1)
    (list 1 -1)
    (list 2 3))) ; ((0 -10) (-3 -1))
</code></pre>

<h3 id="exercise-238">Exercise 2.38<a class="headerlink" href="#exercise-238" title="Permanent link">&para;</a></h3>
<p>For the first pair of statements:</p>
<pre><code class="scheme">(fold-right / 1 (list 1 2 3))
; (/ 1 (fold-right / 1 (list 2 3)))
; (/ 1 (/ 2 (fold-right / 1 (list 3))))
; (/ 1 (/ 2 (/ 3 (fold-right / 1 ()))))
; (/ 1 (/ 2 (/ 3 1)))
; (/ 1 (/ 2 3))
; (/ 1 (0.667)) ; using floating-points instead of rationals for this showcasing
; ==&gt; 1.5

(fold-left  / 1 (list 1 2 3))
; (iter 1 (list 1 2 3))
; (iter (/ 1 1) (list 2 3))
; (iter 1 (list 2 3))
; (iter (/ 1 2) (list 3))
; (iter 0.5 (list 3))
; (iter (/ 0.5 3) ())
; (iter 0.167 ())
; ==&gt; 0.167
</code></pre>

<p>The first statement was <span class="arithmatex">\(1 \div \left(2 \div 3\right)\)</span>, while the second one was <span class="arithmatex">\(\left(1 \div 2\right) \div 3\)</span></p>
<p>For the second pair of statements:</p>
<pre><code class="scheme">(fold-right list () (list 1 2 3))
; (list 1 (fold-right list () (list 2 3)))
; (list 1 (list 2 (fold-right list () (list 3))))
; (list 1 (list 2 (list 3 (fold-right list () ()))))
; (list 1 (list 2 (list 3 ())))
; ==&gt; (1 (2 (3 ())))

(fold-left  list () (list 1 2 3))
; (iter () (list 1 2 3))
; (iter (list () 1) (list 2 3))
; (iter (list (list () 1) 2) (list 3))
; (iter (list (list (list () 1) 2) 3) ())
; ==&gt; (((() 1) 2) 3)
</code></pre>

<p>For <code>fold-left</code> and <code>fold-right</code> to have the same result, <code>(op a b)</code> must equal <code>(op b a)</code>, that is, the order of operations ought not matter.</p>
<h3 id="exercise-239">Exercise 2.39<a class="headerlink" href="#exercise-239" title="Permanent link">&para;</a></h3>
<pre><code class="scheme">(define (reverse sequence)
  (fold-right 
    (lambda (x y)
      (append y (list x)))
    ()
    sequence))
(reverse (list 1 2 3 4)) ; (4 3 2 1)

(define (reverse sequence)
  (fold-left 
    (lambda (x y)
      (cons y x))
    ()
    sequence))
(reverse (list 1 2 3 4)) ; (4 3 2 1)
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../js/mathjax.js" defer></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
